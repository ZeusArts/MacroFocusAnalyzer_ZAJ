Image Focus Analysis Tool
MacroFocusAnalyzer_ZAJ_Version.2.0

Purpose:
This tool is designed to help users analyze the focus or sharpness of a collection of images. It can quickly assess image quality, identify blurry images, and classify them into "OK" (good) and "NG" (bad) folders.

Features:

Browse images within a selected folder.
Analyze image sharpness using the gradient variance method.
Visualize sharpness analysis by highlighting sharp and blurred areas.
Adjust the threshold for sharpness detection.
Zoom and pan images for closer inspection.
Classify images into "OK" and "NG" folders.
Automatically move files to designated destination folders for OK and NG images.
Operating Instructions:

Select Image Folder: Click "Open Image Folder" to select the folder containing the images to be analyzed.
Select OK and NG Folders: Click "Select OK Folder" and "Select NG Folder" to specify where to move the images classified as "OK" and "NG."
Analyze Sharpness: Click "Analyze Sharpness" to perform the focus analysis. Adjust the "Threshold Factor" slider to control the sensitivity of sharpness detection. Check "Show Analysis Results" to visualize highlighted sharp/blurred areas.
Navigate Images: Use "Previous Image" and "Next Image" to browse through the images.
Zoom and Pan: Use the mouse wheel to zoom. Click and drag the image to pan (move) within the canvas. Use "Reset Zoom" to return to the initial view.
Classify Images: Click "OK" to move the current image to the "OK" folder, or click "NG" to move it to the "NG" folder. The tool will automatically proceed to the next image.
Notes:

This tool supports JPG, JPEG, PNG, and BMP image formats.
Be sure to select the OK and NG folders before classifying images.
Purpose of MacroFocusAnalyzer:
This program aims to address the following challenges in macro photography:

Macro photography often requires shooting in full manual mode, which can be difficult due to the unique characteristics of macro lenses, the limitations of focal length due to the relationship between aperture and image brightness, and blur caused by camera shake.

Macro photography involves many challenging factors. Achieving a perfectly focused and beautiful photo often depends on individual technique. For those with vision impairments, such as keratoconus, achieving accurate focus is especially difficult, requiring the photographer to take numerous photos and select the best ones.

Therefore, the primary purpose of this program is to visually identify the in-focus and out-of-focus areas within an image, making manual image selection easier. Visual evaluation also opens up the possibility of using the tool for macro stacking (a technique that combines multiple photos to extend the depth of field).

This program can potentially be used for photo compositing techniques like macro stacking by providing a visual evaluation of focus.

I hope this program reaches those facing similar challenges and seeking solutions, and that it will be of great help.

This program is open source.
Its primary purpose is to benefit others and make an intellectual contribution. You are free to modify this program.
However, please do not forget the goal of "contributing to society for the sake of others." Unauthorized distribution or charging for this program is strictly prohibited.

End-User License Agreement (EULA)

Before using this software (hereinafter referred to as "MacroFocusAnalyzer"), please be sure to read the following End-User License Agreement (hereinafter referred to as "this Agreement"). This Agreement is a legal agreement between you (hereinafter referred to as "the User") and Kleber De Oliveira Kato (GOLDEN-ANTS_MACROVERSE-STUDIO (ZeusArtsJapan)) (hereinafter referred to as "the Licensor") regarding the use of this software.

By downloading, installing, or using this software, the User agrees to all the terms of this Agreement. If you do not agree to the terms of this Agreement, please do not download, install, or use this software.

1. Grant of License

The Licensor grants the User a limited, non-exclusive, non-transferable license to use this software for non-commercial purposes only, in accordance with the terms of this Agreement.

2. Prohibited Activities

The User shall not:

Sell, rent, lease, or distribute this software.
Use this software to assist in creating content for websites whose primary purpose is to generate advertising revenue.
Redistribute this software (whether free of charge or for a fee) on websites that aim to generate advertising revenue.
Attempt to reverse engineer, decompile, or disassemble this software.
Remove, alter, or conceal any copyright notices, trademarks, or other proprietary rights notices in this software.
Use this software beyond the scope expressly permitted by this Agreement.
3. Scope of Non-Commercial Use

Non-commercial use of this software refers to use that does not fall under the "Prohibited Activities" described above. Use of this software in research projects that have received funding is permitted.

4. Indirect Commercial Benefits

This software is a photo analysis tool intended solely for the purpose of photo selection. It is not intended that the files used by this software be processed or output, and it does not directly modify the original files within the file. Therefore, indirect commercial benefits that may arise as a result of using this software are permitted.

5. Limitation of Liability and Disclaimer

This software is provided "as is" without any express or implied warranties. The Licensor makes no warranties, express or implied, as to the merchantability, fitness for a particular purpose, or non-infringement of this software.   

The Licensor shall not be liable for any damages (including, but not limited to, direct, indirect, incidental, special, consequential, or punitive damages) arising out of the use, misuse, or inability to use this software. The User assumes all risks associated with the use of this software.   

By downloading, installing, or using this software, the User acknowledges that they have read, understood, and agreed to the contents of this Agreement, the README file, and other related documents.

6. Governing Law

This Agreement shall be governed by and construed in accordance with the laws of Japan. Any disputes relating to this Agreement shall be subject to the exclusive jurisdiction of the Tokyo District Court as the court of first instance.   

7. Miscellaneous

This Agreement constitutes the entire agreement between the User and the Licensor regarding the use of this software, and supersedes all prior or contemporaneous agreements, understandings, or representations relating to this software.

The Licensor reserves the right to change this Agreement at any time. The changed Agreement shall be effective when notified to the User in the manner specified by the Licensor.

If any provision of this Agreement is held to be invalid or unenforceable by a court of competent jurisdiction, the remaining provisions shall remain in full force and effect.   

Thank you for carefully reading this license agreement and using this software responsibly.

LICENSE INFORMATION AND PRECAUTIONS

MacroFocusAnalyzer_ZAJ_Ver.2.0
Copyright (C) 2025 Kleber De Oliveira Kato
GOLDEN-ANTS_MACROVERSE-STUDIO (ZeusArtsJapan)

This program is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0).

What you can do:

You can freely share (copy, distribute) and modify (create derivative works) this program, provided you give credit (display the copyright notice).
However, commercial use is not permitted (use is only allowed for non-commercial purposes).
If you make modifications, you must also publish them under the same CC BY-NC-SA 4.0 license.
Prohibited activities:

It is prohibited to sell this program for a fee without permission.
Do not remove or fail to properly display the copyright notice (credit).
It is prohibited to use this program to assist in creating content for websites that aim to generate advertising revenue.
Redistribution of this program (whether free of charge or for a fee) on websites that aim to generate advertising revenue is strictly prohibited.
Scope of non-commercial use:
Non-commercial use of this program refers to use that does not fall under the following:

Direct sale of this program.
Use of this program to assist in creating content for websites whose primary purpose is to generate advertising revenue.
Redistribution of this program (whether free of charge or for a fee) on websites that aim to generate advertising revenue.
Use of this program as a tool in funded research is permitted.

Indirect commercial benefits:
This program is a photo analysis tool intended solely for the purpose of photo selection. It is not intended that the files used by this software be processed or output, and it does not directly modify the original files within the file. Therefore, indirect commercial benefits that may arise as a result of using this software are permitted.

Official license information:
For detailed license terms, please refer to the following URL:
https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en

I hope this program will help you evaluate and select photos with good focus in macro photography.

